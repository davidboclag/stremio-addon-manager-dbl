<div class="card">
  <div class="card-body">
    <h5 class="card-title">
      Listado de Addons
      <span class="badge bg-info ms-2">{{ addons.length || 0 }}</span>
    </h5>

    <div *ngIf="!stremioAuthKey" class="alert alert-warning">
      Debes iniciar sesi√≥n en Stremio para ver y editar los addons.
    </div>

    <ul class="list-group mb-3" *ngIf="addons?.length" cdkDropList (cdkDropListDropped)="drop($event)">
      <li
        class="list-group-item d-flex justify-content-between align-items-center"
        *ngFor="let a of addons; let i = index"
        cdkDrag
        style="cursor: grab;"
      >
        <div class="d-flex align-items-center gap-2">
          <i class="bi bi-grip-vertical text-secondary"></i>
          <img
            *ngIf="a?.manifest?.logo || a?.manifest?.icon"
            [src]="a.manifest.logo || a.manifest.icon"
            style="width: 28px; height: 28px; border-radius: 6px"
          />
          <strong>{{ a.manifest?.name || a.transportName }}</strong>
        </div>
        <div>
          <button
            class="btn btn-sm btn-outline-primary me-2"
            (click)="openAddon(a.transportUrl)"
          >
            Abrir
          </button>
          <button
            class="btn btn-sm btn-outline-danger"
            (click)="deleteAddon(i)"
          >
            Eliminar
          </button>
        </div>
      </li>
    </ul>

    <div *ngIf="!addons || addons.length === 0" class="text-muted">
      No hay addons cargados.
    </div>

    <div class="mt-3">
      <button
        class="btn btn-success"
        (click)="saveToStremio()"
        [disabled]="!stremioAuthKey"
      >
        Sincronizar con Stremio
      </button>
      <button
        class="btn btn-outline-danger ms-2"
        (click)="deleteAll()"
        [disabled]="!addons.length"
      >
        Eliminar todos
      </button>
    </div>
  </div>
</div>
